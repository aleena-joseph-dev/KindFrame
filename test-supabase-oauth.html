<!DOCTYPE html>
<html>
<head>
    <title>Supabase Google OAuth Test</title>
    <script src="https://unpkg.com/@supabase/supabase-js@2"></script>
</head>
<body>
    <h1>Supabase Google OAuth Test</h1>
    <button onclick="googleSignIn()">Sign In With Google</button>
    <button onclick="signOut()">Sign Out</button>
    <div id="status"></div>
    
    <script>
        // Initialize Supabase client
        const supabaseUrl = 'https://dlenuyofztbvhzmdfiek.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImRsZW51eW9menRidmh6bWRmaWVrIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM4NjY2NDMsImV4cCI6MjA2OTQ0MjY0M30.vyeTP56KuHKJlpcH-n8L8qFKxQrrvVSSi30S0P2Gv5A';
        
        // Wait for the script to load before creating the client
        window.addEventListener('load', function() {
            window.supabaseClient = window.supabase.createClient(supabaseUrl, supabaseKey);
        });
        
        async function googleSignIn() {
            try {
                if (!window.supabaseClient) {
                    document.getElementById('status').innerHTML = 'Error: Supabase client not initialized';
                    return;
                }
                
                document.getElementById('status').innerHTML = 'Starting OAuth...';
                
                const { error } = await window.supabaseClient.auth.signInWithOAuth({
                    provider: 'google',
                    options: {
                        scopes: 'https://www.googleapis.com/auth/calendar'
                    }
                });
                
                if (error) {
                    document.getElementById('status').innerHTML = 'Error: ' + error.message;
                    console.error('OAuth error:', error);
                } else {
                    document.getElementById('status').innerHTML = 'OAuth initiated successfully!';
                }
            } catch (error) {
                document.getElementById('status').innerHTML = 'Exception: ' + error.message;
                console.error('Exception:', error);
            }
        }

        async function signOut() {
            try {
                if (!window.supabaseClient) {
                    document.getElementById('status').innerHTML = 'Error: Supabase client not initialized';
                    return;
                }
                
                await window.supabaseClient.auth.signOut();
                document.getElementById('status').innerHTML = 'Signed out successfully!';
            } catch (error) {
                document.getElementById('status').innerHTML = 'Sign out error: ' + error.message;
                console.error('Sign out error:', error);
            }
        }
    </script>
</body>
</html> 